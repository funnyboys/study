# 北桥和南桥

## 北桥

连接CPU与高速外设，例如内存、显卡，最新的cpu已将北桥整合进cpu内。

## 南桥

连接CPU与低速外设，例如usb、sata。

# 虚拟地址空间
## 分段和分页
### 分段
将一段程序所需要的虚拟地址空间映射到物理地址。
### 分页
思路和分段相同，也是虚拟地址到物理地址间的映射，只不过粒度更小，以PAGE_SIZE为单位。
## 虚拟地址空间的好处
1. 进程间地址空间隔离(页属性)；
2. 提高内存使用效率，便于复用。
## 虚拟地址空间的实现
虚拟存储的实现需要硬件模块支持，几乎所有的硬件都采用MMU来进行页映射，MMU提供VA和PA之间的转换。

# 线程
## 什么是线程
线程是轻量级进程(lightweight process)，是程序执行的最小单元。
一个进程由一个或多个线程组成，各线程间共享程序的内存空间及部分进程资源。
## 线程的私有空间
thread core local，为线程提供的私有局部空间。
## 线程状态
* running：线程正在运行
* ready：线程所需要的资源已经准备好，正在等待cpu
* waiting：线程正在等待所需要的资源(例如等待I/O或同步发生)
## 可抢占线程和不可抢占线程
### 什么是抢占
线程在用尽时间片后被强制剥夺继续执行的权利，而从running状态变为ready状态，这个过程叫做抢占。
### 不可抢占线程中线程调度时间点
* 线程主动放弃时间片
* 线程试图等待某种事件(I/O或同步)
## Linux中的多线程
Linux中没有进程和线程的概念，统一用task进行管理。
* fork：复制当前task
* exec：使用新的可执行镜像替换当前的可执行镜像
* clone：创建子进程并从指定位置开始执行
### fork
拷贝当前程序，并从fork之后的位置继续开始执行。
根据返回值(pid_t)的不同，判断当前是子进程还是父进程：
* pid = 0：子进程
* pid > 0：父进程，返回值为子进程的pid
```
if ((pid = fork()) == 0)
   print "hello from the child"
else
   print "hello from the parent"
```

# 目标文件

## 目标文件的类型

目标文件不仅仅包括.o文件，动态库、静态库(静态库是.o文件打包而来)和coredump都属于目标文件。

## 目标文件中有什么

编译后的指令机器码、数据、字符串

调试信息、符号表

## 为什么要将指令和数据分离

1. 便于划分两个不同权限的虚拟内存区域，防止代码段被改写。
2. cpu有独立的指令和数据cache，便于提升性能。
3. 指令对于很多进程是完全一致的，可以互相共享，节省内存的使用。